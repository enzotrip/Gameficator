{% extends "GRGameficatorBundle::layout.html.twig" %}

{% block title %}
    <title>Gamificator | New Task</title>
{% endblock title %}



{% block pageheader %}
<div class="pageheader">
    <div class="media">
        <div class="pageicon pull-left">
            <i class="fa fa-file"></i>
        </div>
        <div class="media-body">
            <ul class="breadcrumb">
                <li><a href="{{ path('gr_gameficator_homepage') }}"><i class="glyphicon glyphicon-home"></i></a></li>
                <li>Dashboard</li>
                <li>Créer une tache</li>
            </ul>
            <h4>Créer une tache</h4>
        </div>
    </div><!-- media -->
</div><!-- pageheader -->
{% endblock %}

{% block body %}

{{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}
<div class="row">
     <div class="col-sm-6">
       <div class="form-group">
           <label class="col-sm-2 control-label">Nom de la tâche</label>
           <div class="col-sm-8">
               {{ form_widget(form.name, { 'attr': {'class': 'form-control'} }) }}
            </div>
            {{ form_errors(form.name) }}
     </div>
       </div><!-- form-group -->

       <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Projet(s) lié(s)</label>
           <div class="col-sm-8">
               {{ form_widget(form.project, {'attr': {'class': 'form-control'}}) }}
            </div>
         </div><!-- form-group --></div>
</div>
<div class="row">

       <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Topic</label>
           <div class="col-sm-8">
               <input type="text" class="form-control">
               </div>
         </div><!-- form-group -->
         </div>
       <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Tâche parente</label>
           <div class="col-sm-8">
               <input type="text" class="form-control">
            </div>
         </div><!-- form-group --></div>
</div>

<div class="row">
         <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Récompense</label>
           <div class="col-sm-8">
               <input type="text" class="form-control">
            </div>
         </div><!-- form-group --></div>
         <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Nombre de points</label>
           <div class="col-sm-8">
             {{ form_widget(form.points, { 'attr': {'class': 'form-control'} }) }}
          </div>
          {{ form_errors(form.points) }}
         </div><!-- form-group --></div>
</div>

<div class="row">
         <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Priorité</label>
           <div class="col-sm-8">
               {{ form_widget(form.priority, { 'attr': {'class': 'form-control'} }) }}
            </div>
            {{ form_errors(form.priority) }}
         </div><!-- form-group --></div>
       <div class="col-sm-6"><div class="form-group">
           <label class="col-sm-2 control-label">Couleur</label>
           <div class="col-sm-6">
              {{ form_widget(form.color, {'id': 'colorpicker', 'attr': {'class': 'form-control colorpicker-input'} }) }}
               <span id="colorSelector" class="colorselector">
                  <span></span>
              </span>
            </div>
         </div><!-- form-group --></div>
</div>
<div class="row">
         <div class="form-group">
                    <label class="col-sm-1 control-label">Description</label>
                    <div class="col-sm-10">
                      {{ form_widget(form.description, { 'attr': {'class': 'form-control'} }) }}
                   </div>
                   {{ form_errors(form.description) }}
          </div>
</div>

<div class="row">
      <div class="col-sm-6"><div class="form-group">
          <div class="col-sm-3">
              <div class="rdio rdio-primary">
                {{ form_widget(form.type[0], {'attr':{'class': 'radio_type'}}) }}
                {{ form_label(form.type[0])}}
              </div>
          </div>
          <div class="col-sm-3">
              <div class="input-group" id="echeance" style="display:none">
                  {{ form_widget(form.deadline, {'id': 'datepicker', 'attr': {'class': 'form-control'}})}}
              </div>
        </div>
      </div><!-- form-group --></div>
</div>
<div class="row">
      <div class="col-sm-12"><div class="form-group">
            <div class="col-sm-3">
                <div class="rdio rdio-primary">
                    {{ form_widget(form.type[1], {'attr':{'class': 'radio_type'}}) }}
                    {{ form_label(form.type[1])}}
                </div>
              </div>
          </div>
      </div><!-- form-group --></div>
</div>

<div id="recurrent" class="row" style="display:none">
    <div class="col-sm-12"><div class="form-group">
        <div class="col-sm-2" style="border-right: 1px solid #8E8585">
            <strong>Tous les :</strong>

            <div class="row"></br></div>
            {% for day in form.recurrent.days %}
            <div class="row">
              <div class="ckbox ckbox-primary">
                {{ form_widget(day, { 'attr' :{ 'class': 'ckbox ckbox-primary'}}) }}
                {{ form_label(day)}}
              </div>
            </div>
            {% endfor %}
        </div>

        <div class="col-sm-1"></br></br></br></br></br></br><strong>OU</strong></div>
        <div class="col-sm-4">
            <div class="row"></br></br></br></div>
            <div class="row">
              <div class="form-group">
                <label class="col-sm-3 control-label"><strong>Date de début</strong></label>
                <div class="col-sm-7">
                  {{ form_widget(form.recurrent.startdate, {'id': 'datepicker1', 'attr': {'class': 'form-control'}})}}
                </div>
              </div>
            </div>

            <div class="row"></br></div>

            <div class="row">
              <label class="col-sm-3 control-label"><strong>Tous les : </strong></label>
              <div class="col-sm-3">
                {{ form_widget(form.recurrent.nbchoice2, { 'attr': {'class': 'form-control'} }) }}
              </div>
              <div class="col-sm-4">
               {{ form_widget(form.recurrent.timechoice2, { 'attr': {'class': 'form-control'} }) }}
              </div>
              {{ form_errors(form.recurrent.timechoice2) }}
            </div>
        </div>
        <div class="col-sm-5" style="border-left: 1px solid #8E8585">
          <div class="col-sm-1"></br></br></br></br></br></br><strong>OU</strong></div>
            <div class="row"></br></br></br></br></br>
              <label class="col-sm-2 control-label"><strong>Au moins </strong></label>
              <div class="col-sm-2">
                {{ form_widget(form.recurrent.nbchoice3, { 'attr': {'class': 'form-control'} }) }}
              </div>
              <label class="col-sm-2 control-label"><strong>Fois par </strong></label>
              <div class="col-sm-3">
               {{ form_widget(form.recurrent.timechoice3, { 'attr': {'class': 'form-control'} }) }}
              </div>
              {{ form_errors(form.recurrent.timechoice3) }}
            </div>
            <div class="row"></br></br></br></br></br></br></div>
        </div>

    </div><!-- form-group --></div>
</div>
<div class="form-group">
      <div class=col-sm-offset-1>
          {{ form_widget(form.save, {'label': 'Create Task', attr:{ 'class': 'btn btn-success'}}) }}
      </div>

</div>



{{ form_end(form) }}


{% endblock %}

{% block script %}

<script type="text/javascript">

$('#datepicker').datepicker({dateFormat: 'dd/mm/yy', firstDay: 1});
$('#datepicker1').datepicker({dateFormat: 'dd/mm/yy', firstDay: 1});

  // Color Picker
    if(jQuery('#colorpicker').length > 0) {
      jQuery('#colorSelector').ColorPicker({
        onShow: function (colpkr) {
          jQuery(colpkr).fadeIn(500);
          return false;
        },
        onHide: function (colpkr) {
          jQuery(colpkr).fadeOut(500);
          return false;
        },
        onChange: function (hsb, hex, rgb) {
          jQuery('#colorSelector span').css('backgroundColor', '#' + hex);
          jQuery('#colorpicker').val('#'+hex);
        }
      });
    }
  var choiceradio = document.getElementsByClassName("radio_type");
  console.log(choiceradio);
  for( var i = 0; i < choiceradio.length; i++) {
    choiceradio[i].addEventListener("change", function(e) {
      if(e.target.checked == true && e.target.value == 0) {
        document.getElementById("echeance").style.display = 'block';
        document.getElementById("recurrent").style.display = 'none';
      }
      if(e.target.checked == true && e.target.value == 1) {
        document.getElementById("echeance").style.display = 'none';
        document.getElementById("recurrent").style.display = 'block';
      }
    });
  }
</script>
{% endblock %}
